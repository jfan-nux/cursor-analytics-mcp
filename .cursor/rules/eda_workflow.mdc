# Exploratory Data Analysis (EDA) Workflow

**Goal**: Produce a concise, data-driven analysis report that answers user questions.

## 1. Project Setup
1. Ask for analysis name → create `user-analysis/{analysis_name}/` (per organization rules in `global.mdc`)
2. Create subdirectories: `sql/`, `outputs/`, `logs/`

## 2. Table Context Discovery
**Before writing any queries:**
1. **Check existing context**: Look for existing table context files (see `global.mdc` for file paths)
2. **Search historical patterns**: Use query search tools (see `global.mdc` for instructions)
3. **Create/update context files** using template from `global.mdc`
4. **Reference context** for join patterns, data quality, common use cases

## 3. Data Collection
1. **Review table context** for tables you'll use
2. **Search proven query patterns** with query search tools
3. **Create `load_data.py`** with SQL query functions only (no analysis)
4. **Update table context** with data characteristics discovered

## 4. Data Analysis
1. **Create `analysis.py`** using functions from `load_data.py`
2. **Save sample**: First 100 rows to `sample_data.csv`
3. **Data quality checks**: Missing values, unreasonable values, duplicates
4. **Generate visualizations** and summary statistics → save to `outputs/`
5. **MANDATORY**: Document ALL findings in table context files (follow `global.mdc` template)

## 5. Report Generation
1. **Create `report.py`** with sections:
   - Summary (with Snowflake username)
   - Key findings
   - Detailed analysis with visualizations
   - Data summary and lineage
2. **Generate `report.pdf`** using pandoc (via Python function)
3. **MANDATORY**: Update table context with insights and confirmed queries

## 6. Finalize & Document
1. **Save logs** to `logs/` subdirectory
2. **Verify analysis runs** end-to-end
3. **Complete context documentation checklist** in `.cursor/rules/analysis_history.mdc` for task planning:
   - [ ] Row counts and data characteristics
   - [ ] Data quality issues
   - [ ] Join patterns
   - [ ] Business insights
   - [ ] User-confirmed queries
   - [ ] Related tables
   - [ ] Analysis added to common use cases

## Key EDA-Specific Requirements
- **Always update table context files** at each step
- **Mark queries as user-confirmed** when adding to context
- **Document data quality findings** in context files
- **Include business insights** discovered through analysis
- **Follow table context template** defined in `global.mdc`

