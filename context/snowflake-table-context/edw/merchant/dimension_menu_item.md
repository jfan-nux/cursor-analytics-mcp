# edw.merchant.dimension_menu_item

## Table Overview

**Database:** edw
**Schema:** merchant
**Table:** dimension_menu_item
**Owner:** SYSADMIN
**Row Count:** 3,621,596,738 rows
**Created:** 2024-06-11 23:52:44.542000+00:00
**Last Modified:** 2025-07-17 16:21:30.673000+00:00

**Description:** None

## Business Context

The `DIMENSION_MENU_ITEM` table contains detailed information about menu items offered by various stores, including identifiers, pricing, descriptions, and categorization. This data is essential for businesses in the retail and food service sectors, enabling them to manage inventory, analyze sales trends, and optimize menu offerings. Key use cases include tracking item availability, pricing strategies, and ensuring compliance with dietary restrictions. The table is maintained by the SYSADMIN team, ensuring data integrity and accessibility for analytical purposes.

## Metadata

### Table Metadata

**Type:** BASE TABLE
**Size:** 398346.8 MB
**Transient:** NO
**Retention Time:** 1 days
**Raw Row Count:** 3,621,596,738

### Most Common Joins

| Joined Table | Query Count |
|--------------|-------------|
| edw.merchant.dimension_store | 3575 |
| edw.merchant.dimension_menu | 1945 |
| catalog_service_prod.public.product_item | 1542 |
| proddb.public.dimension_store | 1540 |
| edw.merchant.dimension_business | 865 |
| proddb.public.dimension_order_item | 817 |
| edw.merchant.dimension_menu_category | 746 |
| edw.merchant.dimension_menu_extra | 701 |
| edw.merchant.dimension_menu_option | 699 |
| proddb.public.dimension_deliveries | 594 |

### Column Metadata

| Usage Rank | Column Name | Queries | Ordinal | Data Type | Is Cluster Key | Comment |
|------------|-------------|---------|---------|-----------|----------------|---------|
| 1 | STORE_ID | 7651 | 2 | NUMBER | 1 | Store ID |
| 2 | ITEM_ID | 5600 | 1 | NUMBER | 0 | Menu Item ID |
| 3 | MERCHANT_SUPPLIED_ID | 4304 | 39 | TEXT | 0 | Merchant Supplied ID |
| 4 | MENU_ID | 3884 | 3 | NUMBER | 0 | Menu ID |
| 5 | ITEM_TITLE | 3598 | 6 | TEXT | 0 | Item Name |
| 6 | IS_ITEM_ACTIVE | 3320 | 12 | BOOLEAN | 0 | Item Active Flag |
| 7 | PRICE | 2822 | 9 | NUMBER | 0 | Item Price |
| 8 | IS_MENU_ACTIVE | 1778 | 5 | BOOLEAN | 0 | Menu Active flag |
| 9 | IS_ORDERABLE | 1756 | 13 | BOOLEAN | 0 | This is a Flag which confirms the Item is Active and not Suspended and orderable on platform |
| 10 | PHOTO_ID | 1688 | 43 | TEXT | 0 | ID number for identifying the item photo |
| 11 | CATEGORY_TITLE | 1617 | 18 | TEXT | 0 | Category Name |
| 12 | CATEGORY_ID | 1261 | 17 | NUMBER | 0 | Category ID |
| 13 | PHOTO_URL | 1252 | 44 | TEXT | 0 | url to look for item photo |
| 14 | IS_ALCOHOL | 1120 | 29 | BOOLEAN | 0 | Flag to indicate if item is an alcohol |
| 15 | ITEM_DESCRIPTION | 953 | 7 | TEXT | 0 | Item Description |
| 16 | MENU_TITLE | 739 | 4 | TEXT | 0 | Menu Name |
| 17 | IS_CATEGORY_ACTIVE | 606 | 19 | BOOLEAN | 0 | Category Active Flag |
| 18 | IS_ITEM_SUSPENDED | 586 | 14 | BOOLEAN | 0 | Item Suspension Flag |
| 19 | ORDERABLE_ITEM_PRICE | 516 | 11 | NUMBER | 0 | This is a Calculated Price (Item_Price + Min(Option_price). An Item price could be 0 as the price is |
| 20 | BASE_PRICE | 506 | 10 | NUMBER | 0 | Item Base Price |
| 21 | ITEM_UPDATED_AT | 453 | 63 | TIMESTAMP_NTZ | 0 | Item Updated At |
| 22 | IS_CATEGORY_SUSPENDED | 407 | 20 | BOOLEAN | 0 | Category Suspension Flag |
| 23 | SORT_ID | 379 | 37 | TEXT | 0 | ID used for sorting menu items |
| 24 | ITEM_CREATED_AT | 360 | 62 | TIMESTAMP_NTZ | 0 | Item Created At |
| 25 | MIN_AGE_REQUIREMENT | 325 | 48 | NUMBER | 0 | Minimum age required |
| 26 | __CREATED_TIMESTAMP | 224 | 64 | TIMESTAMP_NTZ | 0 | Row Inserted Timestamp |
| 27 | MIN_PERMITTED | 219 | 49 | NUMBER | 0 | Minimum permitted for ordering item |
| 28 | MAX_PERMITTED | 197 | 50 | NUMBER | 0 | Maximum permitted for ordering item |
| 29 | ITEM_ID_RAW | 102 | 28 | TEXT | 0 | Item ID as in source |
| 30 | DDSIC | 101 | 61 | TEXT | 0 | ddsic is a universal identifier for CnG items. It is how an URPC (Universal Product Catalog) item is |
| 31 | IS_DASHPASS_ENABLED | 91 | 23 | BOOLEAN | 0 | Item DashPass Flag |
| 32 | ARBITRARY_TAGS | 90 | 68 | TEXT | 0 | Arbitrary Tags from Menu Source |
| 33 | ITEM_PURCHASES | 88 | 57 | TEXT | 0 | Item Purchases |
| 34 | ITEM_SUSPENSION_TYPE | 74 | 15 | TEXT | 0 | Item Suspension Type. i.e. Permanent or Temporary |
| 35 | __MODIFIED_TIMESTAMP | 74 | 65 | TIMESTAMP_NTZ | 0 | Row Updated Timestamp |
| 36 | IS_BIKE_FRIENDLY | 72 | 27 | BOOLEAN | 0 | Bike Friendly Flag |
| 37 | DEFAULT_ON | 67 | 51 | TEXT | 0 | Default On |
| 38 | TAX_RATE | 51 | 40 | FLOAT | 0 | Rate at which the item should be taxed |
| 39 | ITEM_CATEGORY_TAG | 40 | 24 | TEXT | 0 | from fact_Food_catalog_v2, provides the top level category tag of an Item |
| 40 | AI_ITEM_DESCRIPTION | 37 | 8 | TEXT | 0 | Item Description Generated by AI |
| 41 | PRODUCT_CODE_ID | 37 | 45 | NUMBER | 0 | Id of the Product |
| 42 | ITEM_FEES | 33 | 59 | TEXT | 0 | Item fees like bottle deposit fee |
| 43 | ALLERGENS | 32 | 33 | TEXT | 0 | Shows if there are any allergens |
| 44 | STORE_INTERNAL_SKU | 31 | 38 | TEXT | 0 | External Item ID from Vendor |
| 45 | DIETARY_TAGS | 30 | 55 | TEXT | 0 | Dietary Tags from Menu Source |
| 46 | DISH_TYPE_TAGS | 28 | 26 | TEXT | 0 | from fact_Food_catalog_v2, provides the dish type tags of an Item |
| 47 | VEHICLE_TYPE | 24 | 47 | TEXT | 0 | Vehicle types that can be used for delivery like car,bike,scooter etc |
| 48 | ALLERGEN_FREE_TAGS | 24 | 69 | TEXT | 0 | Allergen Free Tags from Menu Source |
| 49 | DIETARY_PREFERENCE_TAGS | 22 | 25 | TEXT | 0 | from fact_Food_catalog_v2, provides the dietary preference tags of an Item |
| 50 | SERVICE_TYPES | 21 | 53 | TEXT | 0 | Service Types |
| 51 | IS_ENTREE | 20 | 32 | BOOLEAN | 0 | Flag to indicate if the item is an Entree |
| 52 | CALORIE_DISPLAY_TYPE | 20 | 36 | TEXT | 0 | Calories Displayed As |
| 53 | ORDERABLEPATH | 20 | 46 | TEXT | 0 | Orderable Path |
| 54 | CLASSIFICATION_TAGS | 20 | 54 | TEXT | 0 | Classification Tags from Menu Source |
| 55 | VISIBILITY | 20 | 56 | TEXT | 0 | Visibility |
| 56 | ITEM_SUSPENSION_REASON | 19 | 16 | TEXT | 0 | Item Suspension Reason |
| 57 | CATEGORY_SUSPENSION_TYPE | 19 | 21 | TEXT | 0 | Category Suspension Type |
| 58 | CATEGORY_SUSPENSION_REASON | 19 | 22 | TEXT | 0 | Category Suspension Reason |
| 59 | HAS_SIDE | 19 | 30 | BOOLEAN | 0 | Flag to indicate if a side is available |
| 60 | IS_HOT | 19 | 31 | BOOLEAN | 0 | Flag to indicate if the item is served hot |
| 61 | CALORIE_LOWER_RANGE | 19 | 34 | NUMBER | 0 | Calorie Low Range |
| 62 | CALORIE_HIGHER_RANGE | 19 | 35 | NUMBER | 0 | Calorie high Range |
| 63 | MEMBERSHIP_TYPES | 19 | 41 | TEXT | 0 | Type of Memberships |
| 64 | IS_RECIPE | 19 | 42 | BOOLEAN | 0 | Flag to indicate if the item is a recipe |
| 65 | SERVING_SIZE | 19 | 52 | NUMBER | 0 | Serving Size |
| 66 | BACKWARD_COMPATIBILITY_FIELDS | 19 | 58 | TEXT | 0 | Backward_compatibility_fields |
| 67 | DYNAMIC_PROPERTIES | 19 | 60 | TEXT | 0 | Dynamic Properties |
| 68 | IS_SENSITIVE_DATA | 19 | 66 | TEXT | 0 | Item product category restriction type. Source is catalog_service_prod.public.product_item and prodd |
| 69 | RESTRICTED_ITEM_TYPE | 18 | 70 | TEXT | 0 | restricted item type |
| 70 | SENSITIVITY_LEVEL | 18 | 71 | TEXT | 0 | Sensitive data information |

## Granularity Analysis


## Sample Queries

### Query 1
**Last Executed:** 2025-08-14 13:15:27.048000

```sql
with URPC AS (
    SELECT
        DD_SIC,
        GLOBAL_CATALOG_ID,
        UPPER(INTERNAL_INFORMATION:is_active:value::string) as "is_active",
        CASE 
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type = parse_json('{}') then 'RESTRICTION_TYPE_UNSPECIFIED'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 1 then 'OTC'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 2 then 'ALCOHOL'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 3 then 'LOTTERY'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 4 then 'CANNABIS'
        end as restriction_type
        from 
            CATALOG_SERVICE_PROD.PUBLIC.GLOBAL_PRODUCT_ITEM i
            INNER JOIN (SELECT   dd_sic as max_dd_sic,Max(version) AS max_version FROM catalog_service_prod.PUBLIC.global_product_item AS b GROUP BY b.dd_sic) AS maxver
        where 
            1=1
            AND dd_sic = maxver.max_dd_sic
            AND version = maxver.max_version
            AND "is_active" in ('TRUE')
)

, final as (select distinct i.* exclude(STORE_ID)   
    , f.ITEM_INFO_MERCHANT_SUPPLIED_ITEM_NAME as feed_name
    , f.ITEM_INFO_MERCHANT_SUPPLIED_CATEGORY as feed_category_name
    , f.ITEM_INFO_IS_ALCOHOL feed_isalcohol
    ,p.MERCHANT_SUPPLIED_ID -- use this for CnG to limit Item ID duplicates? 
    ,p.DD_BUSINESS_ID || '_' || p.MERCHANT_SUPPLIED_ID as bmsid 
    , xx.DATE_AUDIT
    , CASE
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '1' THEN 'OTC'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '2' THEN 'ALCOHOL'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '3' THEN 'LOTTERY'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '4' THEN 'CANNABIS'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '5' THEN 'CBD'
            ELSE upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value'))
        END as mpc_restriction_type
       , u.restriction_type as urpc_restriction_type

from proddb.public.fact_alcohol_compliance_inference i
  left JOIN PRODDB.STATIC.DSML_ALCOHOL_TAGGING_MP_RESULTS xx on xx.ITEM_ID = i.ITEM_ID
  left join edw.merchant.dimension_menu_item mi on mi.ITEM_ID = i.ITEM_ID 
  LEFT join edw.merchant.dimension_menu m ON m.MENU_ID =i.menu_id
  left join PRODDB.PUBLIC.DIMENSION_STORE ds on ds.STORE_ID = m.STORE_ID
 -- left join DOORDASH_MERCHANT.PUBLIC.MAINDB_BUSINESS b on b.id = ds.BUSINESS_ID
  left join CATALOG_SERVICE_PROD.PUBLIC.PRODUCT_ITEM p on p.MERCHANT_SUPPLIED_ID = mi.MERCHANT_SUPPLIED_ID and p.DD_BUSINESS_ID = ds.BUSINESS_ID
    left JOIN urpc u on u.dd_sic = p.dd_sic and u.global_catalog_id = p.global_catalog_id
--left join PRODDB.STATIC.LIQUOR_ENTERPRISE le on le.BUSINESS_ID = b.id
  LEFT JOIN IGUAZU.SERVER_EVENTS_PRODUCTION.MERCHANT_PROVIDED_ITEM_INVENTORY_FEED_EVENT f ON (f.ITEM_INFO_BUSINESS_ID = p.DD_BUSINESS_ID AND f.ITEM_INFO_MERCHANT_SUPPLIED_ITEM_ID = p.MERCHANT_SUPPLIED_ID)
where i.pred_label='alcohol' --- predict as alcohol but not in the current system
and coalesce(i.min_age_requirement,0) not in (18,19,21) 
and coalesce(i.is_alcohol,False) = False 
and i.tag_via_audit is null ---never been audited before
and i.created_at > '2020-02-22'
and i.pred_score >= 0.9999 -- add 9s here to make this more precise 
  and mi.IS_ALCOHOL = FALSE
  and mi.IS_ACTIVE = true
  and m.IS_ACTIVE = true
  and ds.IS_ACTIVE = true
  and ds.is_test = FALSE 
  and i.ITEM_NAME not ilike '%Ginger%Beer%' and i.ITEM_NAME not ilike '%Root%Beer%' and i.ITEM_NAME not ilike '%Isopropyl%' and i.ITEM_NAME not ilike '%Fever-Tree%' and i.ITEM_NAME not ilike '%Bitters%' and i.ITEM_NAME not ilike '%Mixer%' and i.ITEM_NAME not ilike '%Mix%' and i.ITEM_NAME not ilike '%Grenadine%' and i.ITEM_NAME not ilike '%Syrup%' and i.ITEM_NAME not ilike '%Nigiri%'
  and i.item_name not ilike '%Bickford%Cordial%' and i.item_name not ilike '%Schweppes%Lemonade%' and i.item_name not ilike '%Cottees%'
  and ds.COUNTRY_ID in (2) -- can add/subtract CAN/AUS
  and (mpc_restriction_type is null and urpc_restriction_type is null)
  --and f.ITEM_INFO_IS_ALCOHOL = true
)

select 
item_name
, count(bmsid) as num_items
from final
group by item_name
order by 2 desc
-- {"user":"@bianca_osagie","email":"bianca.osagie@ext.doordash.com","url":"https://modeanalytics.com/doordash/reports/975df1658d76/runs/3f57ab941548/queries/a719b20d9ce2","scheduled":false}
```

### Query 2
**Last Executed:** 2025-08-14 13:15:26.922000

```sql
with URPC AS (
    SELECT
        DD_SIC,
        GLOBAL_CATALOG_ID,
        UPPER(INTERNAL_INFORMATION:is_active:value::string) as "is_active",
        CASE 
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type = parse_json('{}') then 'RESTRICTION_TYPE_UNSPECIFIED'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 1 then 'OTC'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 2 then 'ALCOHOL'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 3 then 'LOTTERY'
            WHEN EXTERNAL_INFORMATION:compliance:restriction_type:value::string = 4 then 'CANNABIS'
        end as restriction_type
        from 
            CATALOG_SERVICE_PROD.PUBLIC.GLOBAL_PRODUCT_ITEM i
            INNER JOIN (SELECT   dd_sic as max_dd_sic,Max(version) AS max_version FROM catalog_service_prod.PUBLIC.global_product_item AS b GROUP BY b.dd_sic) AS maxver
        where 
            1=1
            AND dd_sic = maxver.max_dd_sic
            AND version = maxver.max_version
            AND "is_active" in ('TRUE')
)

select distinct i.* exclude(item_id, menu_id, STORE_ID, state, proba,TAG_VIA_AUDIT,ITEM_CREATED_AT,PRED_LABEL,PRED_SCORE)   
    , f.ITEM_INFO_MERCHANT_SUPPLIED_ITEM_NAME as feed_name
    , f.ITEM_INFO_MERCHANT_SUPPLIED_CATEGORY as feed_category_name
    , f.ITEM_INFO_IS_ALCOHOL feed_isalcohol
    ,p.MERCHANT_SUPPLIED_ID -- use this for CnG to limit Item ID duplicates? 
    ,p.DD_BUSINESS_ID || '_' || p.MERCHANT_SUPPLIED_ID as bmsid 
    ,ds.BUSINESS_VERTICAL_ID 
    , r.audit_date
    , r.is_alc_audit
    , CASE
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '1' THEN 'OTC'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '2' THEN 'ALCOHOL'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '3' THEN 'LOTTERY'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '4' THEN 'CANNABIS'
            WHEN upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value')) = '5' THEN 'CBD'
            ELSE upper(JSON_EXTRACT_PATH_TEXT(EXTERNAL_INFORMATION, 'compliance.restriction_type.value'))
        END as mpc_restriction_type
       , u.restriction_type as urpc_restriction_type

from proddb.public.fact_alcohol_compliance_inference i
  left join edw.merchant.dimension_menu_item mi on mi.ITEM_ID = i.ITEM_ID 
  LEFT join edw.merchant.dimension_menu m ON m.MENU_ID =i.menu_id
  left join PRODDB.PUBLIC.DIMENSION_STORE ds on ds.STORE_ID = m.STORE_ID
 -- left join DOORDASH_MERCHANT.PUBLIC.MAINDB_BUSINESS b on b.id = ds.BUSINESS_ID
  left join CATALOG_SERVICE_PROD.PUBLIC.PRODUCT_ITEM p on p.MERCHANT_SUPPLIED_ID = mi.MERCHANT_SUPPLIED_ID and p.DD_BUSINESS_ID = ds.BUSINESS_ID
    left JOIN urpc u on u.dd_sic = p.dd_sic and u.global_catalog_id = p.global_catalog_id
      left JOIN PRODDB.STATIC.DSML_ALCOHOL_TAGGING_RETAIL_UI_RESULTS r on r.business_id = p.DD_BUSINESS_ID and r.msid = p.MERCHANT_SUPPLIED_ID 
--left join PRODDB.STATIC.LIQUOR_ENTERPRISE le on le.BUSINESS_ID = b.id
  LEFT JOIN IGUAZU.SERVER_EVENTS_PRODUCTION.MERCHANT_PROVIDED_ITEM_INVENTORY_FEED_EVENT f ON (f.ITEM_INFO_BUSINESS_ID = p.DD_BUSINESS_ID AND f.ITEM_INFO_MERCHANT_SUPPLIED_ITEM_ID = p.MERCHANT_SUPPLIED_ID)
where i.pred_label='alcohol' --- predict as alcohol but not in the current system
and coalesce(i.min_age_requirement,0) not in (18,19,21) 
and coalesce(i.is_alcohol,False) = False 
and i.tag_via_audit is null ---never been audited before
and i.item_created_at > '2020-02-22'--date should be '2020-02-22'
and i.pred_score > 0.99
  and mi.IS_ALCOHOL = FALSE
  and mi.IS_ITEM_ACTIVE = true
  and m.IS_ACTIVE = true
  and ds.IS_ACTIVE = true
  and ds.is_test = FALSE 
  and i.ITEM_NAME not like '%Ginger Beer%' and i.ITEM_NAME not like '%Root Beer%' and i.ITEM_NAME not like '%Isopropyl%' and i.ITEM_NAME not like '%Fever-Tree%' and i.ITEM_NAME not like '%Bitters%' and i.ITEM_NAME not like '%Mixer%' and i.ITEM_NAME not like '%Mix%' and i.ITEM_NAME not like '%Grenadine%' and i.ITEM_NAME not like '%Syrup%' and i.ITEM_NAME not like '%Nigiri%'
  and ds.BUSINESS_ID not in (11247591, 45294,11175654) --known non-alc Mx
  and ds.COUNTRY_ID = 1
  and (mpc_restriction_type is null and urpc_restriction_type is null)
  and p.MERCHANT_SUPPLIED_ID is not null
  --and f.ITEM_INFO_IS_ALCOHOL = true
-- {"user":"@bianca_osagie","email":"bianca.osagie@ext.doordash.com","url":"https://modeanalytics.com/doordash/reports/975df1658d76/runs/3f57ab941548/queries/3caccb282ed1","scheduled":false}
```

